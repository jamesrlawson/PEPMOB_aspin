{
    "collab_server" : "",
    "contents" : "require(readr)\nrequire(ggplot2)\n\nsource('scripts/regression_outputs.R')\n\nphys <- read_csv('data/Aspinwall_leafphys_170623.csv')\nprot <- read_csv('data/Aspinwall_proteomics_170623.csv')\nprot <- prot[-97,]\n\nphys_prot <- merge(phys, prot, by = c('id', 'temp_treatment', 'time', 'species'))\n\nphys_prot$temp_treatment <- as.factor(phys_prot$temp_treatment)\nphys_prot$time <- factor(phys_prot$time, levels = c('pre_heatwave', 'heatwave', 'post_1day', 'post_6day'))\nphys_prot$species <- factor(phys_prot$species, levels = c('eucbot', 'eucsmi', 'eucter', 'euccam'))\nphys_prot$log10gs <- log10(phys_prot$gs)\n#phys_prot$log10HSPs <- log10(phys_prot$HSPs)\n\nphys_prot_pre <- phys_prot[phys_prot$time == 'pre_heatwave',]\nphys_prot_heatwave <- phys_prot[phys_prot$time == 'heatwave',]\nphys_prot_post_1day <- phys_prot[phys_prot$time == 'post_1day',]\nphys_prot_post_6day <- phys_prot[phys_prot$time == 'post_6day',]\n\n##### HSPs #####\n\n# single regression per timepoint\n\nggplot(phys_prot, aes(y=HSPs, x=log10gs)) +\n  geom_point(size = 2, aes(color=species, shape = temp_treatment)) +\n  geom_smooth(method=lm,se=FALSE) +\n  scale_colour_hue(l=50) +  # Use a slightly darker palette than normal)\n  facet_grid(. ~ time, scales = \"free_x\") +\n  ylab('Heat Shock Protein (mg / m2)') +\n  xlab('log10(Gs) (mmol H20 / s / m2)') \n\ntemp_spp_lumped_HSPs <- regression_output(phys_prot, c('time'), HSPs, log10gs)\nwrite.csv(temp_spp_lumped_HSPs, 'output/hsps_vs_log10gs_temp_spp_lumped_170623.csv')\n\n# one regression per species, temp treatments lumped\n\nggplot(phys_prot, aes(y=HSPs, x=log10gs, color = species)) +\n  geom_point(size = 2, aes(color=species, shape = temp_treatment)) +\n  geom_smooth(method=lm,se=FALSE) +\n  scale_colour_hue(l=50) +  # Use a slightly darker palette than normal)\n  facet_grid(. ~ time, scales = \"free_x\") +\n  ylab('Heat Shock Protein (mg / m2)') +\n  xlab('log10(Gs) (mmol H20 / s / m2)') \n\ntemp_lumped_HSPs <- regression_output(phys_prot, c('time', 'species'), HSPs, log10gs)\nwrite.csv(temp_lumped_HSPs, 'output/hsps_vs_log10gs_temp_lumped_170623.csv')\n\n# one regression per temp treatment, species lumped\n\nggplot(phys_prot, aes(y=HSPs, x=log10gs, shape = temp_treatment, linetype = temp_treatment)) +\n  geom_point(size = 2, aes(color=species, shape = temp_treatment)) +\n  geom_smooth(method=lm,se=FALSE) +\n  scale_colour_hue(l=50) +  # Use a slightly darker palette than normal)\n  facet_grid(. ~ time, scales = \"free_x\") +\n  ylab('Heat Shock Protein (mg / m2)') +\n  xlab('log10(Gs) (mmol H20 / s / m2)') \n\nspp_lumped_HSPs <- regression_output(phys_prot, c('time', 'temp_treatment'), HSPs, log10gs)\nwrite.csv(spp_lumped, 'output/hsps_vs_log10gs_spp_lumped_170623.csv')\n\n# regressions for every combination of species and treatment\n\nggplot(phys_prot, aes(y=HSPs, x=gs, color=species, shape = temp_treatment, linetype = temp_treatment)) +\n  geom_point(size = 2) +\n  geom_smooth(method=lm,se=FALSE) +\n  scale_colour_hue(l=50) +  # Use a slightly darker palette than normal)\n  facet_grid(. ~ time, scales = \"free_x\") +\n  ylab('Heat Shock Protein (mg / m2)') +\n  xlab('log10(Gs) (mmol H20 / s / m2)')\n\nall_models_HSPs <- regression_output(phys_prot, c('time', 'temp_treatment', 'species'), HSPs, log10gs)\nwrite.csv(spp_lumped, 'output/hsps_vs_log10gs_all_models_170623.csv')\n\n# HSPs vs log10gs, data = heatwave minus preheatwave\n\nphys_prot1 <- phys_prot\nHSPs_stand <- subset(phys_prot1, time == 'heatwave')$HSPs - subset(phys_prot1, time == 'pre_heatwave')$HSPs\nlog10gs_stand <- subset(phys_prot1, time == 'heatwave')$log10gs - subset(phys_prot1, time == 'pre_heatwave')$log10gs\nplot(HSPs_stand ~ log10gs_stand, main = \"HSPs vs log10gs, heatwave vals standardised by pre_heatwave vals\")\nmodel <- lm(HSPs_stand ~ log10gs_stand)\nabline(model)\nsummary(model)\nplot(model)\n\n####### HSPs + protein folding #######\n\nphys_prot$HSPs_protein <- phys_prot$HSPs + phys_prot$protein\n\n# single regression per timepoint\n\nggplot(phys_prot, aes(y=HSPs_protein, x=log10gs)) +\n  geom_point(size = 2, aes(color=species, shape = temp_treatment)) +\n  geom_smooth(method=lm,se=FALSE) +\n  scale_colour_hue(l=50) +  # Use a slightly darker palette than normal)\n  facet_grid(. ~ time, scales = \"free_x\") +\n  ylab('Heat Shock Protein + protein folding (mg / m2)') +\n  xlab('log10(Gs) (mmol H20 / s / m2)') \n\ntemp_spp_lumped_HSPs_protein <- regression_output(phys_prot, c('time'), HSPs_protein, log10gs)\nwrite.csv(temp_spp_lumped_HSPs_protein, 'output/HSPs_protein_vs_log10gs_temp_spp_lumped_170623.csv')\n\n# one regression per species, temp treatments lumped\n\nggplot(phys_prot, aes(y=HSPs_protein, x=log10gs, color = species)) +\n  geom_point(size = 2, aes(color=species, shape = temp_treatment)) +\n  geom_smooth(method=lm,se=FALSE) +\n  scale_colour_hue(l=50) +  # Use a slightly darker palette than normal)\n  facet_grid(. ~ time, scales = \"free_x\") +\n  ylab('Heat Shock Protein + protein folding (mg / m2)') +\n  xlab('log10(Gs) (mmol H20 / s / m2)') \n\ntemp_lumped_HSPs_protein <- regression_output(phys_prot, c('time', 'species'), HSPs_protein, log10gs)\nwrite.csv(temp_lumped_HSPs_protein, 'output/HSPs_proteinvs_log10gs_temp_lumped_170623.csv')\n\n# one regression per temp treatment, species lumped\n\nggplot(phys_prot, aes(y=HSPs_protein, x=log10gs, shape = temp_treatment, linetype = temp_treatment)) +\n  geom_point(size = 2, aes(color=species, shape = temp_treatment)) +\n  geom_smooth(method=lm,se=FALSE) +\n  scale_colour_hue(l=50) +  # Use a slightly darker palette than normal)\n  facet_grid(. ~ time, scales = \"free_x\") +\n  ylab('Heat Shock Protein + protein folding (mg / m2)') +\n  xlab('log10(Gs) (mmol H20 / s / m2)') \n\nspp_lumped_HSPs_protein <- regression_output(phys_prot, c('time', 'temp_treatment'), HSPs_protein, log10gs)\nwrite.csv(spp_lumped_HSPs_protein, 'output/HSPs_protein_vs_log10gs_spp_lumped_170623.csv')\n\n# regressions for every combination of species and treatment\n\nggplot(phys_prot, aes(y=HSPs_protein, x=gs, color=species, shape = temp_treatment, linetype = temp_treatment)) +\n  geom_point(size = 2) +\n  geom_smooth(method=lm,se=FALSE) +\n  scale_colour_hue(l=50) +  # Use a slightly darker palette than normal)\n  facet_grid(. ~ time, scales = \"free_x\") +\n  ylab('Heat Shock Protein + protein folding (mg / m2)') +\n  xlab('log10(Gs) (mmol H20 / s / m2)')\n\nall_models_HSPs_protein <- regression_output(phys_prot, c('time', 'temp_treatment', 'species'), HSPs, log10gs)\n\n\n#### abiotic stress + protein folding ####\n\nphys_prot$abioticStress_protein <- phys_prot$abiotic_stress + phys_prot$protein\n\n# single regression per timepoint\n\nggplot(phys_prot, aes(y=abioticStress_protein, x=log10gs)) +\n  geom_point(size = 2, aes(color=species, shape = temp_treatment)) +\n  geom_smooth(method=lm,se=FALSE) +\n  scale_colour_hue(l=50) +  # Use a slightly darker palette than normal)\n  facet_grid(. ~ time, scales = \"free_x\") +\n  ylab('Protein folding + abiotic stress response (mg / m2)') +\n  xlab('log10(Gs) (mmol H20 / s / m2)') \n\ntemp_spp_lumped_protein_abiotic <- regression_output(phys_prot, c('time'), abioticStress_protein, log10gs)\nwrite.csv(temp_spp_lumped_abioticStress_protein, 'output/abioticStress_protein_vs_log10gs_temp_spp_lumped_170623.csv')\n\n# one regression per species, temp treatments lumped\n\nggplot(phys_prot, aes(y=abioticStress_protein, x=log10gs, color = species)) +\n  geom_point(size = 2, aes(color=species, shape = temp_treatment)) +\n  geom_smooth(method=lm,se=FALSE) +\n  scale_colour_hue(l=50) +  # Use a slightly darker palette than normal)\n  facet_grid(. ~ time, scales = \"free_x\") +\n  ylab('Protein folding + abiotic stress response (mg / m2)') +\n  xlab('log10(Gs) (mmol H20 / s / m2)') \n\ntemp_lumped_protein_abiotic <- regression_output(phys_prot, c('time', 'species'), abioticStress_protein, log10gs)\nwrite.csv(temp_lumped_HSPs_protein, 'output/abioticStress_protein_vs_log10gs_temp_lumped_170623.csv')\n\n# one regression per temp treatment, species lumped\n\nggplot(phys_prot, aes(y=abioticStress_protein, x=log10gs, shape = temp_treatment, linetype = temp_treatment)) +\n  geom_point(size = 2, aes(color=species, shape = temp_treatment)) +\n  geom_smooth(method=lm,se=FALSE) +\n  scale_colour_hue(l=50) +  # Use a slightly darker palette than normal)\n  facet_grid(. ~ time, scales = \"free_x\") +\n  ylab('Protein folding + abiotic stress response (mg / m2)') +\n  xlab('log10(Gs) (mmol H20 / s / m2)') \n\nspp_lumped_protein_abiotic <- regression_output(phys_prot, c('time', 'temp_treatment'), abioticStress_protein, log10gs)\nwrite.csv(spp_lumped_HSPs_protein, 'output/abioticStress_protein_vs_log10gs_spp_lumped_170623.csv')\n\n# regressions for every combination of species and treatment\n\nggplot(phys_prot, aes(y=abioticStress_protein, x=gs, color=species, shape = temp_treatment, linetype = temp_treatment)) +\n  geom_point(size = 2) +\n  geom_smooth(method=lm,se=FALSE) +\n  scale_colour_hue(l=50) +  # Use a slightly darker palette than normal)\n  facet_grid(. ~ time, scales = \"free_x\") +\n  ylab('Protein folding + abiotic stress response (mg / m2)') +\n  xlab('log10(Gs) (mmol H20 / s / m2)')\n\nall_models_protein_abiotic <- regression_output(phys_prot, c('time', 'temp_treatment', 'species'), HSPs, log10gs)\n\n\n#### stress + protein folding ####\n\nphys_prot$stress_protein <- phys_prot$stress + phys_prot$protein\n\n# single regression per timepoint\n\nggplot(phys_prot, aes(y=stress_protein, x=log10gs)) +\n  geom_point(size = 2, aes(color=species, shape = temp_treatment)) +\n  geom_smooth(method=lm,se=FALSE) +\n  scale_colour_hue(l=50) +  # Use a slightly darker palette than normal)\n  facet_grid(. ~ time, scales = \"free_x\") +\n  ylab('Protein folding + stress response (mg / m2)') +\n  xlab('log10(Gs) (mmol H20 / s / m2)') \n\ntemp_spp_lumped_protein_stress <- regression_output(phys_prot, c('time'), stress_protein, log10gs)\nwrite.csv(temp_spp_lumped_stress_protein, 'output/stress_protein_vs_log10gs_temp_spp_lumped_170623.csv')\n\n# one regression per species, temp treatments lumped\n\nggplot(phys_prot, aes(y=stress_protein, x=log10gs, color = species)) +\n  geom_point(size = 2, aes(color=species, shape = temp_treatment)) +\n  geom_smooth(method=lm,se=FALSE) +\n  scale_colour_hue(l=50) +  # Use a slightly darker palette than normal)\n  facet_grid(. ~ time, scales = \"free_x\") +\n  ylab('Protein folding + stress response (mg / m2)') +\n  xlab('log10(Gs) (mmol H20 / s / m2)') \n\ntemp_lumped_protein_stress <- regression_output(phys_prot, c('time', 'species'), stress_protein, log10gs)\nwrite.csv(temp_lumped_HSPs_protein, 'output/stress_protein_vs_log10gs_temp_lumped_170623.csv')\n\n# one regression per temp treatment, species lumped\n\nggplot(phys_prot, aes(y=stress_protein, x=log10gs, shape = temp_treatment, linetype = temp_treatment)) +\n  geom_point(size = 2, aes(color=species, shape = temp_treatment)) +\n  geom_smooth(method=lm,se=FALSE) +\n  scale_colour_hue(l=50) +  # Use a slightly darker palette than normal)\n  facet_grid(. ~ time, scales = \"free_x\") +\n  ylab('Protein folding + stress response (mg / m2)') +\n  xlab('log10(Gs) (mmol H20 / s / m2)') \n\nspp_lumped_protein_stress <- regression_output(phys_prot, c('time', 'temp_treatment'), stress_protein, log10gs)\nwrite.csv(spp_lumped_HSPs_protein, 'output/stress_protein_vs_log10gs_spp_lumped_170623.csv')\n\n# regressions for every combination of species and treatment\n\nggplot(phys_prot, aes(y=stress_protein, x=gs, color=species, shape = temp_treatment, linetype = temp_treatment)) +\n  geom_point(size = 2) +\n  geom_smooth(method=lm,se=FALSE) +\n  scale_colour_hue(l=50) +  # Use a slightly darker palette than normal)\n  facet_grid(. ~ time, scales = \"free_x\") +\n  ylab('Protein folding + stress response (mg / m2)') +\n  xlab('log10(Gs) (mmol H20 / s / m2)')\n\nall_models_protein_stress <- regression_output(phys_prot, c('time', 'temp_treatment', 'species'), HSPs, log10gs)\n\n",
    "created" : 1466653798588.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3331828374",
    "id" : "91C16389",
    "lastKnownWriteTime" : 1466734061,
    "last_content_update" : 1466734061461,
    "path" : "C:/Users/James/Desktop/stuff/PEPMOB/Aspinwall/scripts/protein vs Gs lm.R",
    "project_path" : "scripts/protein vs Gs lm.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}